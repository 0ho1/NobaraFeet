local a = game:GetService("Players")
local b = game:GetService("ReplicatedStorage")
local d = game:GetService("Workspace")
local e = a.LocalPlayer
local g = b.Remotes:WaitForChild("ServerCombatHandler")

assert(isnetworkowner, "does not support isnetworkowner.")
task.wait()

local originalCFrame = e.Character.HumanoidRootPart.CFrame
local bossKilled = false

local function s()
	coroutine.resume(coroutine.create(function()
		for y, z in next, d.Entities:GetChildren() do
			if not game.Players:GetPlayerFromCharacter(z) then
				if z.Name ~= e.Name and z:FindFirstChild("Head") then
					e.Character.HumanoidRootPart.CFrame = z.HumanoidRootPart.CFrame * CFrame.new(0, 2.5, 0) * CFrame.Angles(math.rad(-90), 0, 0)
					e.Character.HumanoidRootPart.Velocity = Vector3.new()
					if e.Character:FindFirstChild("Zanpakuto") then
						e.Character.CharacterHandler.Remotes.Weapon:FireServer()
					end
					g:FireServer("LightAttack")
					if isnetworkowner(z.HumanoidRootPart) then
						z.Head:Destroy()
						task.wait()
						z.Humanoid.Health = 0
						e.Character.HumanoidRootPart.CFrame = z.HumanoidRootPart.CFrame * CFrame.new(0, 10, 0) * CFrame.Angles(math.rad(-90), 0, 0)
						e.Character.HumanoidRootPart.Velocity = Vector3.new()
						bossKilled = true
					end
				end
			end
		end
	end))
end

local Connection

task.spawn(
        function()
            Connection = c.Heartbeat:Connect(
                function()
                    if not bossKilled then
			s()
		    else
			task.wait()
    			e.Character.HumanoidRootPart.CFrame = originalCFrame
			Connection:Disconnect()
		    end
                end
            )
        end
)
